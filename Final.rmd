---
title: "Covid91 vaccine study Final2022"
author: "Carmen Ramos-Caminos"
output: 
  html_document:
    number_sections: true
    toc: true
    toc_depth: 5
date: "`r Sys.Date()`" 
---

```{r include=FALSE,echo=FALSE}
require(tidyverse)
require(tigerstats)
require(forcats)
FinalDat <-read.csv(file="final_Data.csv",header=TRUE)
#recode to remove the annoying "X" from the dataframe
FinalData <- FinalDat  %>% select(-one_of("X"))
FinalData <- FinalData %>%
mutate(across(where(is.character), as.factor))
FinalData$treatment <- relevel(FinalData$treatment,ref="placebo")
#FinalData$infected <- relevel(FinalData$infected,ref="OK")
Females = filter(FinalData,sex=="F")
Males = filter(FinalData,sex=="M")
LGBTQ = filter(FinalData,LGBTQ=="straight")
LGBTQ = filter(FinalData,LGBTQ=="gay")
DrugUser = filter(FinalData, DrugUser=="no")
DrugUser = filter(FinalData, DrugUser=="yes")
Infected = filter(FinalData, infected=="covid19")
```

# Introduction

A new  preventative vaccine (covid91) is under test in clinical trials. Given the nature of this vaccine it is suspected that the drug may exhibit different effectiveness across the variety of subpopulations tracked. Consider population subgroups by gender( guys and gals), drug use, and sexual orientation. Write a complete report that separately considers this drug for each subgroup and your recommendations as to whether people in the subgroup should take the vaccine. Structure your report in four sections each devoted to one of the four subgroups, use null and alternative hypothesis statements and correct statistical verbage when referencing p-values in conclusions.  

Is the new preventative vaccine (covid91) treatment effective for the following subgroups sex (male/female), LGBTQ, DrugUser? 

$H_0$ Preventative covid91 vaccine treatment is not effective for subgroup: sex (male/female): LGBTQ: DrugUser 

$H_a$ Preventative covid91 treatment is effective for subgroup: sex (male/female): LGBTQ: DrugUser 

# Methods 

Both treatment and subgroups sex(male/female), LGBTQ, DrugUser are categorical variables. Therefore, the method of analysis technique used is cat~cat. I will use a barchart for graphical results , a crosstable for numerical results, a chi-square test and fisher exact test for inference.  

# Descriptive Results

## Males   

### Graphic Descriptive Results   

```{r}
dd2 <- male %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))
basicC <- ggplot(dd2,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")
#Now for percentage plot
basicCC <- ggplot(dd2,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```
  


### Numerical Descriptive Results  

```{r}
table1 <- xtabs(~infected + treatment, data=male)
rowPerc(table1)
colPerc(table1)
```
  

  
### Inferential Results 

```{r}
chisq.test(table1)
chisqtestGC(table1)
malefish <- fisher.test(table1)
malefish
```



## Females 

### Graphic Descriptive Results 

```{r}
dd2 <- female %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))
basicC <- ggplot(dd2,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")
#Now for percentage plot
basicCC <- ggplot(dd2,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```



### Numerical Descriptive Results 

```{r}
table1 <- xtabs(~infected + treatment, data=female)
rowPerc(table1)
colPerc(table1)
```



### Inferential Results

```{r}
chisq.test(table1)
chisqtestGC(table1)
femalefish <- fisher.test(table1)
femalefish
```



## LGBTQ 

### Graphic Descriptive Results  

```{r}
dd2 <- gay %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))
basicC <- ggplot(dd2,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")
#Now for percentage plot
basicCC <- ggplot(dd2,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```



### Numerical Descriptive Results 

```{r}
table1 <- xtabs(~infected + treatment, data=gay)
rowPerc(table1)
colPerc(table1)
```



### Inferential Results

```{r}
chisq.test(table1)
chisqtestGC(table1)
gayfish <- fisher.test(table1)
gayfish
```



## Druggies

### Graphic Descriptive Results  

```{r}
dd2 <- Druguser %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))
basicC <- ggplot(dd2,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")
#Now for percentage plot
basicCC <- ggplot(dd2,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```



### Numerical Descriptive Results 

```{r}
table1 <- xtabs(~infected + treatment, data=Druguser)
rowPerc(table1)
colPerc(table1)
```



### Inferential Results

```{r}
chisq.test(table1)
chisqtestGC(table1)
Druguserfish <- fisher.test(table1)
Druguserfish
```



# Discussion and Conclusion 












